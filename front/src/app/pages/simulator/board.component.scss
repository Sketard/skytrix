@use 'sim-tokens' as *;

:host {
  display: block;
  width: 100%;
  height: 100%;
}

.board-container {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  overflow: hidden;
  touch-action: none;
  background: var(--surface-base);
  position: relative;
}

// Wrapper that receives transform: scale() — scales grid + hand together on desktop
.board-scaler {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  width: 1060px;
  transform-origin: top center;
  transition: transform 200ms ease;
}

.sim-board {
  display: grid;
  grid-template-areas:
    '.     .     emz-l   .      emz-r   .      banish'
    'field m1    m2      m3     m4      m5     gy'
    'ed    st1   st2     st3    st4     st5    deck';
  grid-template-columns: repeat(7, 148px);
  grid-template-rows: 200px 200px 200px;
  gap: $sim-gap-zone-px;
  width: 1060px;
  height: 608px;
  flex-shrink: 0;
}

// Desktop hand inside scaler — overlaps the S/T row for a denser layout
// and reduces scaler reference height → board scales larger on big screens.
app-sim-hand:not(.mobile-hand) {
  width: 1060px;
  height: 160px;
  margin-top: calc(#{$sim-gap-zone-px} - #{$sim-hand-overlap});
  position: relative;
  z-index: 2;
}

// Mobile layout: driven by isMobile() signal via .mobile-layout class,
// NOT media queries — avoids mismatch with JS breakpoint
// (JS also matches (max-width: 1023px) and (max-height: 500px))
.board-container.mobile-layout {
  justify-content: flex-end; // push content to bottom (thumb-friendly)
}

.mobile-layout .board-scaler {
  transform-origin: bottom center;
}

// .mobile-hand only exists in DOM when isMobile() = true — safe without media query
.mobile-hand {
  width: 100%;
  flex-shrink: 0;
  height: $sim-hand-height-landscape;
  margin-top: -$sim-hand-overlap-mobile;
  position: relative;
  z-index: 2;
  touch-action: pan-x; // override parent touch-action: none for horizontal scroll
}

@media (orientation: portrait) {
  .mobile-hand {
    height: $sim-hand-height-portrait;
  }
}
